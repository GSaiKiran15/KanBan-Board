question,answer
"What's the difference between authentication and authorization?","Authentication = proving WHO you are (verifying token). Authorization = proving you have PERMISSION for a specific resource (checking ownership)"
"What does the authenticate middleware do?","It verifies the Firebase token is valid and sets req.user with the decoded token data (uid, email, etc). It does NOT check resource ownership"
"What property contains the user ID from Firebase tokens?","req.user.uid (NOT req.user.id)"
"When should you add the authenticate middleware to an endpoint?","Whenever the endpoint reads or modifies user-specific data or sensitive resources"
"Should /api/newUser be protected with authenticate?","No - it's called during registration when the user doesn't have a session yet"
"What are the two layers of API protection?","Layer 1: Authentication (authenticate middleware - who you are). Layer 2: Authorization (ownership check - do you own this resource)"
"What does EXISTS return in SQL?","A boolean - true if any row matches the condition, false if no matches"
"What's the SQL pattern for checking if a project belongs to a user?","SELECT EXISTS(SELECT 1 FROM projects WHERE id=$1 AND owner_id=$2)"
"Why use EXISTS instead of SELECT *?","More efficient - database stops searching after first match, doesn't fetch column data, returns a clear true/false"
"What is a subquery?","A query nested inside another query. Example: WHERE id = (SELECT project_id FROM boards WHERE id = $1)"
"What's the ownership chain in this app?","User → Project → Board → Card (elements)"
"To check if a board belongs to a user, what do you query?","Check if the board's project belongs to the user: SELECT owner_id FROM projects WHERE id = (SELECT project_id FROM boards WHERE id=$1)"
"Should you check ownership BEFORE or AFTER fetching data?","BEFORE - don't waste time querying data if you're going to reject the request"
"Why do we need security checks if they add ~2ms overhead?","Because: 1) Prevents data breaches, 2) Even bugs can cause unauthorized access, 3) Users can manipulate requests, 4) Security is foundational not optional"
"What's wrong with: pool.query('SELECT * FROM boards WHERE id=$1')?","Missing the parameter array like [id] at the end"
"In moveCard, what TWO things need authorization?","1) The source board (where card currently is), 2) The destination board (where you're moving it to)"
"What HTTP status code for unauthorized (no token)?","401 Unauthorized"
"What HTTP status code for forbidden (token valid but no permission)?","403 Forbidden"
"What's wrong with: app.get('/api/boards/:id', async (req, res))?","Missing authenticate middleware"
"If you only filter by owner_id in queries, do you still need authenticate?","YES - authenticate gives you req.user.uid to use in the WHERE clause"
"What's the pattern for CREATE operations (POST)?","1) Require authenticate, 2) Use req.user.uid for ownership fields (never trust client input)"
"What's the pattern for READ operations (GET)?","1) Require authenticate, 2) Filter by owner_id = req.user.uid in the query"
"What's the pattern for DELETE/UPDATE operations?","1) Require authenticate, 2) Verify ownership before allowing the action"
"Why is 'security overhead' not wasting time?","Network latency (50-200ms) is much larger than security checks (~2-5ms). Security is 2-5% of total request time"
"What happens if you skip the ownership check?","Anyone can access/modify anyone else's data by guessing IDs"
"Common mistake: const uid = req.user.___","id (WRONG) - should be req.user.uid"
"How do you check if a card belongs to a user?","Trace ownership: card → board → project → user. Check if project.owner_id matches user"
"What does 'SELECT 1' mean in EXISTS queries?","'I don't care about the data, just whether a row exists' - it's conventional and efficient"
"Why use subqueries instead of separate queries?","Can do it in one database round-trip, and the logic is clear in a single SQL statement"
"In DELETE operations, should you check ownership?","YES - otherwise anyone can delete anyone's resources by guessing the ID"